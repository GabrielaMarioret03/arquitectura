<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Principal - Gestor de Archivos</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #0a0a0a, #000);
      color: #f1f1f1;
    }

    /* ====== HEADER ====== */
    header {
      background: rgba(20, 20, 20, 0.95);
      color: #ff3b3b;
      padding: 15px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 15px rgba(255, 59, 59, 0.3);
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .user-name {
      font-size: 18px;
      font-weight: bold;
      color: #fff;
    }

    /* ====== MEN√ö ====== */
    .menu {
      position: relative;
      display: inline-block;
    }

    .menu button {
      background: transparent;
      border: 2px solid #ff3b3b;
      color: #ff3b3b;
      font-size: 22px;
      cursor: pointer;
      padding: 8px 14px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .menu button:hover {
      background: #ff3b3b;
      color: #fff;
      box-shadow: 0 0 10px rgba(255, 59, 59, 0.6);
    }

    .menu-content {
      display: none;
      position: absolute;
      right: 0;
      background: #111;
      min-width: 180px;
      box-shadow: 0 8px 20px rgba(255, 59, 59, 0.3);
      border-radius: 10px;
      overflow: hidden;
      z-index: 1000;
      border: 1px solid #ff3b3b;
    }

    .menu-content a {
      color: #ff3b3b;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      font-weight: bold;
      transition: 0.3s;
    }

    .menu-content a:hover {
      background: #ff3b3b;
      color: #000;
    }

    .menu.show .menu-content {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ====== CONTENEDOR ====== */
    .container {
      display: flex;
      flex-wrap: wrap;
      padding: 30px;
      gap: 25px;
      justify-content: center;
    }

    .left {
      width: 320px;
      background: linear-gradient(145deg, #111, #1a1a1a);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(255, 59, 59, 0.2);
      border: 1px solid #2a2a2a;
    }

    .left h3 {
      color: #ff3b3b;
      text-align: center;
      font-family: 'Orbitron', sans-serif;
    }

    select, input[type="file"], button {
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      border-radius: 10px;
      border: 1px solid #444;
      background: #0a0a0a;
      color: #f1f1f1;
      font-size: 15px;
      transition: all 0.3s;
    }

    select:focus, input[type="file"]:focus {
      outline: none;
      border-color: #ff3b3b;
      box-shadow: 0 0 10px rgba(255, 59, 59, 0.5);
    }

    .confirm {
      background: linear-gradient(90deg, #ff3b3b, #a80000);
      color: white;
      border: none;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .cancel {
      background: #333;
      color: #fff;
      border: 1px solid #555;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .confirm:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(255, 59, 59, 0.7);
    }

    .cancel:hover {
      background: #ff3b3b;
      color: #000;
    }

    .right {
      flex: 1;
      min-width: 400px;
    }

    /* ====== SEMANAS ====== */
    .accordion {
      background: #111;
      color: #ff3b3b;
      cursor: pointer;
      padding: 15px;
      border: 1px solid #ff3b3b;
      text-align: left;
      outline: none;
      font-size: 16px;
      margin-bottom: 8px;
      border-radius: 10px;
      transition: 0.3s;
      font-family: 'Orbitron', sans-serif;
    }

    .accordion:hover {
      background: #ff3b3b;
      color: #000;
      transform: translateY(-2px);
    }

    .panel {
      display: none;
      padding: 15px;
      background: #1a1a1a;
      border-radius: 10px;
      margin-bottom: 10px;
      animation: fadeIn 0.3s ease-in-out;
      border: 1px solid #2a2a2a;
    }

    .file-item {
      background: #111;
      padding: 12px;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: 0 2px 8px rgba(255, 59, 59, 0.2);
      border: 1px solid #2a2a2a;
    }

    .file-actions button {
      margin: 5px 5px 0 0;
      padding: 8px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    .view { background: #ff3b3b; color: #000; }
    .download { background: #b80000; color: #fff; }
    .delete { background: #2b0000; color: #ff3b3b; }

    .view:hover, .download:hover, .delete:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(255, 59, 59, 0.5);
    }

    iframe, img {
      max-width: 100%;
      max-height: 200px;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px solid #ff3b3b;
    }

    h1 {
      text-align: center;
      color: #ff3b3b;
      text-shadow: 0 0 20px rgba(255, 59, 59, 0.5);
      font-family: 'Orbitron', sans-serif;
      margin-top: 40px;
    }
  </style>
</head>

<body>
  <header>
    <div class="user-name">üë§ Usuario: <span id="userName">Administrador</span></div>
    <div class="menu" id="menu">
      <button onclick="toggleMenu()">‚ò∞</button>
      <div class="menu-content" style="display:none;">
        <a href="index.html">üìå Portada</a>
        <a href="sobreElCurso.html">üìñ Sobre el curso</a>

      </div>
    </div>
  </header>

  <main>
    <h1>üìÅ Bienvenido al Gestor de Archivos del Curso</h1>
    <div class="container">
      <div class="left">
        <h3>Subir archivo</h3>
        <label for="week">Selecciona la semana:</label>
        <select id="week">
          <option value="">-- Seleccionar --</option>
          <script>
            for(let i=1; i<=16; i++) {
              document.write(`<option value="Semana ${i}">Semana ${i}</option>`);
            }
          </script>
        </select>
        <input type="file" id="fileInput">
        <button class="confirm" onclick="confirmUpload()">‚úÖ Confirmar</button>
        <button class="cancel" onclick="cancelUpload()">‚ùå Cancelar</button>
      </div>

      <div class="right" id="weeksContainer"></div>
    </div>
  </main>

  <script>
    let selectedFile = null;

    // ‚úÖ SIN INICIO DE SESI√ìN ‚Äî nombre fijo ‚ÄúInvitado‚Äù
    document.getElementById("userName").textContent = "Invitado";

    function toggleMenu() {
      const menuContent = document.querySelector(".menu-content");
      menuContent.style.display = menuContent.style.display === "block" ? "none" : "block";
    }

    const weeksContainer = document.getElementById("weeksContainer");
    for (let i = 1; i <= 16; i++) {
      let btn = document.createElement("button");
      btn.className = "accordion";
      btn.textContent = "üìÖ Semana " + i;
      btn.onclick = function() {
        this.classList.toggle("active");
        let panel = this.nextElementSibling;
        panel.style.display = panel.style.display === "block" ? "none" : "block";
      };

      let panel = document.createElement("div");
      panel.className = "panel";
      panel.id = "Semana " + i;
      panel.innerHTML = `<div class="files"></div>`;

      weeksContainer.appendChild(btn);
      weeksContainer.appendChild(panel);
    }

    document.getElementById("fileInput").addEventListener("change", (e) => {
      selectedFile = e.target.files[0];
    });

    function confirmUpload() {
      const week = document.getElementById("week").value;
      if (!week || !selectedFile) {
        alert("Selecciona semana y archivo.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        let storedFiles = JSON.parse(localStorage.getItem(week)) || [];
        storedFiles.push({ 
          name: selectedFile.name, 
          data: e.target.result 
        });
        localStorage.setItem(week, JSON.stringify(storedFiles));
        renderFiles();
        alert("Archivo guardado en " + week);
      };
      reader.readAsDataURL(selectedFile);
    }

    function cancelUpload() {
      window.location.href = "Bienvenida.html";
    }

    function renderFiles() {
      for (let i = 1; i <= 16; i++) {
        const weekDiv = document.querySelector(`#Semana\\ ${i} .files`);
        weekDiv.innerHTML = "";
        let storedFiles = JSON.parse(localStorage.getItem("Semana " + i)) || [];
        storedFiles.forEach((file, index) => {
          let div = document.createElement("div");
          div.className = "file-item";
          div.innerHTML = `
            <p><b>${file.name}</b></p>
            <div class="file-actions">
              <button class="view" onclick="viewFile('${file.data}')">üëÅ Ver</button>
              <button class="download" onclick="downloadFile('${file.data}', '${file.name}')">‚¨á Descargar</button>
              <button class="delete" onclick="deleteFile('Semana ${i}', ${index})">üóë Borrar</button>
            </div>
          `;
          if (file.name.match(/\.(png|jpg|jpeg|gif)$/i)) {
            div.innerHTML += `<img src="${file.data}" alt="preview">`;
          } else if (file.name.endsWith(".pdf")) {
            div.innerHTML += `<iframe src="${file.data}"></iframe>`;
          }
          weekDiv.appendChild(div);
        });
      }
    }

    function viewFile(data) {
      let newWindow = window.open();
      newWindow.document.write(`<iframe src="${data}" style="width:100%; height:100%"></iframe>`);
    }

    function downloadFile(data, name) {
      let a = document.createElement("a");
      a.href = data;
      a.download = name;
      a.click();
    }

    function deleteFile(week, index) {
      let storedFiles = JSON.parse(localStorage.getItem(week)) || [];
      storedFiles.splice(index, 1);
      localStorage.setItem(week, JSON.stringify(storedFiles));
      renderFiles();
    }

    renderFiles();
  </script>
</body>
</html>
